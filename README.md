# Proyek-Pertama-Machine-Learning-Terapan

###### Disusun oleh : Adhim Khairil Anam
Ini adalah proyek pertama analisis prediktif untuk memenuhi submission Dicoding Kelas Machine Learning Terapan.

## 1. Project Domain

### Latar Belakang
Domain proyek "Medical Insurance Premium Prediction". Proyek ini berfokus pada sektor asuransi kesehatan, yang merupakan bagian vital dari industri asuransi secara keseluruhan. Asuransi kesehatan menyediakan perlindungan finansial terhadap risiko medis bagi individu dan keluarga mereka, dengan membebankan sejumlah premi kepada nasabah sebagai imbalan atas jaminan perlindungan tersebut.

Keterkaitan Proyek dengan Industri Asuransi Kesehatan:

1. Estimasi Premi yang Lebih Presisi
Model prediktif yang dikembangkan dalam proyek ini dirancang untuk membantu perusahaan asuransi dalam menghitung premi asuransi kesehatan secara lebih akurat. Model ini memanfaatkan berbagai variabel yang berpengaruh terhadap risiko kesehatan seseorang—seperti usia, riwayat penyakit kronis, keberadaan penyakit kanker dalam keluarga, riwayat operasi besar, serta data antropometrik seperti tinggi dan berat badan—untuk memberikan estimasi premi yang sesuai dengan profil risiko individu.

2. Keadilan dalam Penetapan Premi
Pendekatan berbasis data ini juga bertujuan menciptakan sistem penetapan premi yang lebih adil. Dengan mempertimbangkan seluruh faktor risiko yang relevan secara menyeluruh, model ini membantu menghindari ketimpangan dalam perhitungan premi. Artinya, nasabah akan dikenakan biaya asuransi yang sepadan dengan tingkat risiko kesehatan mereka, sehingga tercipta rasa keadilan dalam pembiayaan perlindungan kesehatan.

Keuntungan bagi Perusahaan Asuransi:

Perhitungan Premi Berdasarkan Risiko Nyata:
Model ini memungkinkan perusahaan asuransi menentukan besaran premi berdasarkan risiko aktual yang dimiliki setiap individu. Pendekatan ini membantu perusahaan dalam mengelola potensi kerugian dan menjaga kestabilan finansial jangka panjang.

Efisiensi Proses Penetapan Premi:
Dengan mengintegrasikan teknologi analitik dalam penetapan tarif, perusahaan dapat mempercepat proses penilaian risiko dan penghitungan premi, sehingga menghemat waktu dan sumber daya operasional.

Keuntungan bagi Calon Nasabah:

Premi yang Proporsional dan Transparan:
Melalui analisis komprehensif terhadap faktor risiko, calon nasabah akan menerima penawaran premi yang sebanding dengan profil kesehatan mereka. Hal ini mempermudah mereka dalam memahami dasar perhitungan premi dan menerima besarannya dengan lebih terbuka.

Perlindungan yang Disesuaikan dengan Kebutuhan:
Dengan premi yang dihitung berdasarkan risiko individu, nasabah memperoleh perlindungan finansial yang sesuai dengan kondisi dan kebutuhan medis pribadi mereka. Ini memberikan rasa aman yang lebih tinggi terhadap kemungkinan risiko kesehatan di masa depan.

Proyek Medical Insurance Premium Prediction memberikan kontribusi yang nyata bagi kedua belah pihak—perusahaan asuransi maupun calon nasabah. Perusahaan dapat meningkatkan akurasi dan efisiensi dalam menentukan premi, sementara nasabah menerima estimasi biaya yang lebih adil dan perlindungan yang sesuai dengan kebutuhan kesehatan mereka.

## 2. Business Understanding
Proyek ini dirancang untuk sebuah perusahaan asuransi kesehatan dengan ciri-ciri bisnis sebagai berikut:

1. Perusahaan Berbasis Data dan Analitik:
Perusahaan ini memiliki fokus kuat pada pemanfaatan data untuk mendukung pengambilan keputusan strategis. Mereka memahami pentingnya teknologi analitik prediktif dan algoritma machine learning dalam menghitung premi asuransi secara tepat berdasarkan risiko individual.

2. Ketersediaan Data Nasabah yang Lengkap:
Perusahaan memiliki akses ke data pelanggan yang komprehensif dan mendalam. Data ini mencakup informasi demografis seperti usia, histori kesehatan, riwayat medis keluarga, alergi, catatan operasi, hingga data antropometrik seperti berat dan tinggi badan. Seluruh informasi ini menjadi aset penting dalam pembangunan model prediktif yang andal.

3. Orientasi pada Daya Saing Pasar:
Untuk memenangkan persaingan di sektor asuransi kesehatan, perusahaan berupaya memanfaatkan teknologi prediktif guna menyempurnakan sistem perhitungan premi, menawarkan tarif yang lebih presisi, dan menghadirkan produk yang unggul dan kompetitif bagi calon nasabah.
Dengan memahami kondisi dan orientasi bisnis perusahaan ini, proyek ini dirancang untuk memberikan solusi yang selaras dengan kebutuhan dan target bisnis mereka.

Melalui proyek Medical Insurance Premium Prediction, perusahaan dengan karakteristik seperti di atas dapat meraih berbagai manfaat berikut:

1. Perhitungan Premi yang Lebih Tepat Sasaran:
Model prediktif yang dikembangkan mampu menyajikan estimasi premi berdasarkan variabel risiko yang relevan seperti usia, histori medis, riwayat keluarga, hingga data fisik pelanggan. Dengan pendekatan berbasis data ini, perusahaan dapat menghitung premi dengan lebih akurat dan konsisten, sekaligus meminimalisir risiko kerugian akibat penetapan premi yang tidak tepat.

2. Efisiensi Proses dan Peningkatan Produktivitas:
Penggunaan teknologi machine learning memungkinkan proses penetapan premi dilakukan secara otomatis, cepat, dan minim kesalahan. Ini mengurangi ketergantungan pada metode manual, menghemat waktu operasional, serta meningkatkan efektivitas sumber daya manusia yang dimiliki perusahaan.

3. Pengambilan Keputusan yang Lebih Terinformasi:
Model ini memberi wawasan yang lebih tajam terkait faktor-faktor risiko yang berpengaruh terhadap premi. Dengan analisis ini, perusahaan dapat memahami perilaku dan kebutuhan pelanggan secara lebih mendalam, sekaligus menemukan pola dan tren yang dapat digunakan untuk pengembangan strategi bisnis yang lebih terarah.

4. Meningkatkan Daya Saing di Industri:
Dengan model perhitungan premi yang lebih akurat dan berbasis data, perusahaan mampu menyusun penawaran yang lebih menarik dan kompetitif. Ini membuka peluang untuk menjangkau lebih banyak calon nasabah, memperluas basis pelanggan, dan membangun loyalitas jangka panjang.

Secara keseluruhan, implementasi model prediktif dalam proyek ini memberi perusahaan alat yang kuat untuk meningkatkan kualitas keputusan bisnis, mengoptimalkan operasional, memperkuat posisi kompetitif, serta memberikan layanan yang lebih sesuai dan memuaskan bagi pelanggan mereka.

## 3. Problem Statements

- Apa langkah yang dapat diambil untuk meningkatkan akurasi dalam menentukan premi asuransi kesehatan?
Perusahaan asuransi sering menghadapi kesulitan dalam menetapkan premi yang tepat dan proporsional untuk calon pemegang polis, karena keterbatasan dalam memahami variabel-variabel yang memengaruhi besaran premi.

Melalui proyek ini, kami berupaya mengatasi permasalahan tersebut dengan membangun model prediktif berbasis data yang mampu menghasilkan estimasi premi dengan tingkat akurasi yang lebih tinggi dan konsisten.

- Bagaimana caranya untuk meningkatkan transparansi dalam penetapan premi asuransi kesehatan?
Calon nasabah kerap merasa tidak mendapatkan kejelasan terkait alasan di balik besaran premi yang ditawarkan kepada mereka. Ketidakpahaman ini menimbulkan kesan bahwa proses penentuan premi dilakukan secara tidak transparan.

Dalam proyek ini, kami akan mengidentifikasi dan menampilkan faktor-faktor kunci yang paling berpengaruh dalam perhitungan premi. Dengan demikian, calon pemegang polis dapat memahami dasar logis di balik nilai premi yang dikenakan kepada mereka.

- Bagaimana risiko keuangan yang terkait dengan penentuan premi yang tidak akurat dapat dikurangi?
Penetapan premi yang tidak sesuai dapat memicu risiko finansial bagi perusahaan. Jika premi terlalu rendah untuk kelompok berisiko tinggi, klaim yang diajukan bisa melebihi pendapatan premi. Sebaliknya, premi yang terlalu tinggi dapat menyebabkan penurunan minat terhadap produk asuransi.

Melalui pendekatan prediktif berbasis risiko individual, proyek ini bertujuan meminimalkan ketidakseimbangan tersebut dan mendukung kebijakan premi yang lebih realistis dan berkelanjutan.

Contoh Faktor Spesifik yang Menyebabkan Masalah Tersebut:
1. Kurangnya akurasi dalam penentuan premi:

  - Permasalahan: Ketidakjelasan dalam identifikasi faktor risiko utama yang memengaruhi biaya asuransi, seperti riwayat kesehatan pribadi dan keluarga, gaya hidup, usia, atau jenis kelamin.

  - Ilustrasi: Seorang individu dengan riwayat keluarga penyakit jantung mungkin dikenakan premi yang tidak sesuai karena kurangnya pemahaman terhadap korelasi antara faktor genetik dan risiko kesehatan.

2. Minimnya transparansi dalam proses penetapan premi:

  - Permasalahan: Informasi yang terbatas mengenai elemen-elemen yang digunakan dalam perhitungan premi menyebabkan kebingungan bagi calon pemegang polis.

  - Ilustrasi: Calon nasabah tidak menyadari bahwa variabel seperti kebiasaan merokok, indeks massa tubuh (BMI), atau riwayat medis sebelumnya secara signifikan memengaruhi nilai premi.

3. Tingginya risiko keuangan bagi perusahaan:

  - Permasalahan: Ketidaktepatan dalam menetapkan premi dapat menimbulkan ketidakseimbangan antara pendapatan premi dan biaya klaim.

  - Ilustrasi: Apabila perusahaan menetapkan premi rendah untuk kelompok dengan risiko kesehatan tinggi, klaim yang diterima bisa melampaui nilai premi yang terkumpul, sehingga mengganggu stabilitas finansial perusahaan.

Solusi Melalui Proyek Ini:
Dalam proyek Medical Insurance Premium Prediction, berbagai faktor risiko akan dianalisis secara menyeluruh dan dimasukkan sebagai variabel input dalam model prediktif. Dengan menerapkan teknik machine learning, model ini akan mengestimasi premi secara lebih presisi berdasarkan karakteristik risiko individu.

Selain menghasilkan estimasi premi yang lebih akurat, model ini juga akan mengungkap faktor-faktor utama yang berkontribusi terhadap perhitungan premi. Dengan demikian, perusahaan asuransi dapat menyampaikan informasi yang lebih jelas kepada calon nasabah, meningkatkan transparansi dan membangun kepercayaan yang lebih tinggi terhadap produk asuransi yang ditawarkan.

## 4. Goals

Proyek ini dirancang dengan sejumlah tujuan utama sebagai berikut:

1. Pengembangan Model Prediktif
Sasaran utama proyek ini adalah membangun sebuah model prediksi yang mampu mengestimasi premi asuransi kesehatan dengan akurasi yang tinggi. Melalui pemanfaatan teknik machine learning dan analisis data yang menyeluruh, proyek ini bertujuan menghasilkan model yang dapat memperkirakan besaran premi berdasarkan parameter risiko yang relevan dari masing-masing individu.

2. Peningkatan Tingkat Transparansi
Proyek ini juga bertujuan untuk memperjelas proses penetapan premi asuransi kepada calon pemegang polis. Dengan mengenali faktor-faktor yang memiliki pengaruh signifikan terhadap besaran premi, proyek ini berupaya memberikan pemahaman yang lebih dalam kepada pelanggan mengenai alasan di balik jumlah premi yang dikenakan, sehingga dapat menumbuhkan rasa percaya dan kepuasan terhadap penyedia layanan asuransi.

3. Pengurangan Risiko Finansial
Tujuan lain yang ingin dicapai adalah membantu perusahaan asuransi dalam menekan risiko keuangan yang dapat timbul akibat ketidaktepatan dalam penentuan premi. Melalui estimasi premi yang lebih akurat dan berbasis pada faktor risiko yang aktual, perusahaan dapat lebih efektif dalam mengelola risiko finansial, menghindari potensi kerugian, serta menjaga stabilitas ekonomi perusahaan.

Metrik Evaluasi Keberhasilan:
Untuk menilai sejauh mana tujuan proyek ini berhasil dicapai, digunakan beberapa metrik evaluasi berikut:

- Akurasi Prediksi
Digunakan untuk mengukur tingkat ketepatan model dalam memperkirakan premi asuransi. Semakin tinggi akurasi yang dicapai, semakin besar kontribusi model terhadap pencapaian tujuan pertama.

- Indeks Transparansi
Dapat diukur melalui survei terhadap calon pemegang polis guna menilai pemahaman mereka atas dasar perhitungan premi yang diterapkan. Peningkatan pemahaman dan kepercayaan menunjukkan pencapaian terhadap tujuan peningkatan transparansi.

- Indikator Risiko Keuangan
Dapat dinilai dengan membandingkan performa keuangan perusahaan asuransi sebelum dan sesudah implementasi model prediktif. Penurunan tingkat kerugian atau peningkatan stabilitas keuangan menjadi indikator keberhasilan dalam tujuan pengurangan risiko finansial.

- Mean Squared Error (MSE)
Metrik statistik ini digunakan untuk mengukur selisih kuadrat antara nilai premi prediksi dan nilai aktual. Semakin kecil nilai MSE, semakin baik kinerja model dalam memberikan estimasi yang mendekati kenyataan.

Pemilihan dan penerapan metrik yang sesuai dengan sasaran proyek sangat penting untuk memastikan evaluasi yang objektif dan mendalam terhadap hasil implementasi, baik dari sisi operasional perusahaan maupun dari perspektif calon nasabah.

## 5. Solution statements

Solusi untuk proyek ini dirancang melalui sejumlah tahap terstruktur dan pemanfaatan algoritma pembelajaran mesin yang sesuai. Penjabaran solusi secara rinci disampaikan sebagai berikut:

1. Analisis Data Awal (Exploratory Data Analysis - EDA)

  - Sebelum model dibangun dan dilatih, langkah pertama adalah melakukan eksplorasi data untuk memahami struktur, distribusi, dan pola dalam dataset.

  - Proses EDA ini bertujuan untuk mengidentifikasi korelasi antar variabel, mengenali anomali atau pencilan dalam data, serta menggali wawasan awal yang penting     untuk menunjang proses pemodelan prediksi premi asuransi kesehatan.

2. Penerapan Algoritma SVR dan Huber Regressor

  - Algoritma Support Vector Regression (SVR) dan Huber Regressor dipilih sebagai pendekatan utama dalam membangun model prediktif.

  - SVR merupakan metode regresi yang mampu memetakan hubungan kompleks antara variabel input dan output. Dalam proyek ini, SVR digunakan untuk memperkirakan nilai premi berdasarkan profil risiko individu.

  - Sementara itu, Huber Regressor dikenal memiliki ketahanan terhadap pencilan (outlier), menjadikannya solusi ideal untuk data yang tidak sepenuhnya bersih atau memiliki nilai ekstrem. Algoritma ini mampu memberikan hasil prediksi yang konsisten dan andal meskipun terdapat gangguan data.

3. Pemanfaatan Library PyCaret

  - Untuk mempercepat dan mempermudah proses pemodelan, proyek ini akan menggunakan PyCaret, sebuah library otomasi pembelajaran mesin yang mendukung berbagai algoritma.

  - PyCaret memungkinkan eksplorasi dan komparasi berbagai model machine learning secara efisien, sehingga mempermudah proses pemilihan model yang paling sesuai dengan karakteristik data yang tersedia.

  - Selain itu, fitur-fitur otomatisasi dalam PyCaret mempercepat siklus pengujian model tanpa mengorbankan akurasi atau kualitas hasil.

4. Evaluasi Model Menggunakan Mean Squared Error (MSE)

  - Untuk menilai performa model yang dikembangkan, digunakan metrik Mean Squared Error (MSE), yang merupakan ukuran standar dalam kasus regresi.

  - MSE menghitung rata-rata kuadrat selisih antara nilai yang diprediksi oleh model dan nilai aktual, memberikan indikasi seberapa jauh estimasi premi yang dihasilkan dari kenyataan.

  - Semakin kecil nilai MSE, semakin akurat dan andal model tersebut dalam melakukan prediksi.
Pemilihan algoritma terbaik dalam proyek ini dilakukan secara iteratif melalui proses evaluasi kinerja menggunakan PyCaret. Model-model yang dibangun akan diuji dan dibandingkan berdasarkan nilai MSE untuk memastikan solusi akhir yang dipilih adalah yang paling optimal dalam memprediksi premi asuransi kesehatan.

Dengan strategi pemodelan seperti ini, proyek diharapkan mampu menghasilkan sistem prediktif yang unggul dalam ketepatan, efisiensi, dan relevansi terhadap kebutuhan industri asuransi kesehatan.

## 6. Data Understanding

Dataset yang digunakan dalam proyek ini merupakan data parameter terkait kesehatan yang diberikan hampir oleh 1000 konsumen secara sukarela.

Dataset dapat diunduh di: [Medical Insurance Premium Prediction](https://www.kaggle.com/datasets/tejashvi14/medical-insurance-premium-prediction).

### Sample data
| Age | Diabetes | BloodPressureProblems | AnyTransplants | AnyChronicDiseases | Height | Weight | KnownAllergies | HistoryOfCancerInFamily | NumberOfMajorSurgeries | PremiumPrice |
|-----|----------|-----------------------|----------------|--------------------|--------|--------|----------------|-------------------------|-----------------------|--------------|
| count | 986.000000 | 986.000000 | 986.000000 | 986.000000 | 986.000000 | 986.000000 | 986.000000 | 986.000000 | 986.000000 | 986.000000 |
| mean | 41.745436 | 0.419878 | 0.468560 | 0.055781 | 0.180527 | 168.182556 | 76.950304 | 0.215010 | 0.117647 | 0.667343 | 24336.713996 |
| std | 13.963371 | 0.493789 | 0.499264 | 0.229615 | 0.384821 | 10.098155 | 14.265096 | 0.411038 | 0.322353 | 0.749205 | 6248.184382 |
| min | 18.000000 | 0.000000 | 0.000000 | 0.000000 | 0.000000 | 145.000000 | 51.000000 | 0.000000 | 0.000000 | 0.000000 | 15000.000000 |
| 25% | 30.000000 | 0.000000 | 0.000000 | 0.000000 | 0.000000 | 161.000000 | 67.000000 | 0.000000 | 0.000000 | 0.000000 | 21000.000000 |
| 50% | 42.000000 | 0.000000 | 0.000000 | 0.000000 | 0.000000 | 168.000000 | 75.000000 | 0.000000 | 0.000000 | 1.000000 | 23000.000000 |
| 75% | 53.000000 | 1.000000 | 1.000000 | 0.000000 | 0.000000 | 176.000000 | 87.000000 | 0.000000 | 0.000000 | 1.000000 | 28000.000000 |
| max | 66.000000 | 1.000000 | 1.000000 | 1.000000 | 1.000000 | 188.000000 | 132.000000 | 1.000000 | 1.000000 | 3.000000 | 40000.000000 |

Berikut informasi pada dataset :

- Dataset memiliki format CSV (Comma-Seperated Values).
- Dataset memiliki 986 sample dengan 11 fitur.
- Dataset memiliki 11 fitur bertipe int64.
- Tidak ada missing value dalam dataset.

### Variabel-variabel pada Medical Insurance Premium Prediction dataset adalah sebagai berikut:
- Age : merupakan rentang umur dari pasien tersebut
- Diabetes : apakah pasien tersebut memiliki kadar gula darah abnormal atau tidak
- BloodPressureProblems: apakah pasien tersebut memiliki tingkat tekanan darah abnormal
- AnyTransplants: pernah melakukan transplantasi organ utama apapun
- AnyChronicDiseases: apakah pasien menderita penyakit kronis seperti asthama, dll
- Height: rentang tinggi badan pasien
- Weight: rentang berat badan pasien
- KnownAllergies: apakah pasien memiliki alergi yang diketahui
- HistoryOfCancerInFamily: apakah ada relatif darah dari pasien yang mengidap bentuk kanker apa pun
- NumberOfMajorSurgeries: jumlah operasi besar yang dijalani pasien tersebut
- PremiumPrice: harga premium tahunan

### Pendalaman Data Understanding
- Melakukan tahapan EDA seperti mendeskripsikan variabel, mencari *outlier*s, Univariate hingga Multi-variate analysis.
- Untuk menganalisa *outlier*s bisa menggunaka boxplot dengan memanggil fungsi .plot() pada pandas
- Mengecek data missing value dan membersihkan data missing value dengan membuat simple logic program
- Menggunakan histogram untuk melihat penyebaran data dengan *library* pandas fungsi .hist()
- Mencari keterkaitan antar fitur numerik dan fitur kategori dengan correlation matrix menggunakan fungsi pandas dan visualisasi heatmap dengan seaborn.

Dengan menggunakan pendekatan Interquartile Range (IQR) dan visualisasi boxplot, data pencilan (outlier) dapat dikenali dan ditangani secara efektif. Outlier merupakan nilai-nilai yang berada jauh di luar rentang mayoritas data dan dapat menyebabkan bias pada analisis statistik maupun kinerja model prediktif.

Melalui penghitungan IQR dan interpretasi boxplot, batas atas dan bawah dari nilai normal dapat ditentukan. Titik-titik data yang melampaui batas ini dikategorikan sebagai outlier. Tindakan yang dapat dilakukan terhadap outlier mencakup penghapusan atau penyesuaian nilai, agar proses analisis data tetap valid dan akurat.

Untuk memperoleh pemahaman yang lebih menyeluruh mengenai distribusi data, histogram dapat digunakan sebagai alat visualisasi. Histogram menyajikan distribusi frekuensi variabel dalam bentuk interval atau bin.

Langkah-langkah dalam melakukan analisis distribusi data dengan histogram meliputi:

1. Pembentukan Interval (Bin):
Data dibagi ke dalam sejumlah interval yang setara, dengan jumlah bin ditentukan menggunakan kaidah statistik seperti Sturges' Rule atau Scott's Rule, tergantung pada karakteristik data.

2. Penghitungan Frekuensi:
Jumlah observasi dalam setiap bin dihitung untuk mengetahui frekuensi kemunculan nilai-nilai dalam rentang tersebut.

3. Pembuatan Histogram:
Histogram kemudian dibentuk dengan sumbu horizontal mewakili interval nilai dan sumbu vertikal menunjukkan jumlah kemunculan (frekuensi). Visualisasi menggunakan batang (bars) untuk mewakili masing-masing interval.

4. Analisis Visual:
Melalui histogram, pola distribusi data menjadi lebih jelas. Apakah data bersifat normal, miring ke kiri atau kanan, atau memiliki dua puncak (bimodal) dapat dengan mudah diidentifikasi. Informasi ini sangat bermanfaat untuk menentukan langkah analisis selanjutnya.

Histogram menyediakan cara yang cepat dan intuitif untuk melihat pola umum dalam dataset. Penggunaan histogram sebagai bagian dari eksplorasi awal data memberikan gambaran penting sebelum melangkah ke tahap modeling atau prediksi lanjutan.

Terakhir, untuk menganalisis keterkaitan antara fitur numerik dan fitur kategori, dapat diterapkan correlation matrix dengan menggunakan fungsi pandas dan visualisasi heatmap menggunakan pustaka seaborn.

Heatmap menampilkan tingkat korelasi antara setiap pasangan fitur numerik dan fitur kategori. Intensitas warna dalam heatmap mencerminkan tingkat korelasi, di mana warna yang lebih terang menandakan korelasi yang lebih kuat, sementara warna yang lebih gelap menandakan korelasi yang lebih lemah atau tidak ada korelasi sama sekali.

Hubungan positif atau negatif antara fitur numerik dan fitur kategori dapat diamati berdasarkan nilai korelasi. Analisis ini membantu memahami hubungan antar fitur dalam dataset dan memberikan wawasan yang berharga untuk pemilihan fitur, pembuatan model, atau analisis lebih lanjut.

Dengan menggunakan correlation matrix dan visualisasi heatmap, keterkaitan antara fitur numerik dan fitur kategori dalam dataset dapat dianalisis secara visual dan kuantitatif dengan mudah.

## 7. Data Preparation

Berikut ada teknik yang digunakan dalam proses data preparation, yaitu:

Proses One Hot Encoding pada variabel kategorikal merupakan metode untuk mengubah data kategori menjadi format numerik yang dapat diproses oleh algoritma machine learning.

Hal ini diperlukan karena kebanyakan algoritma machine learning hanya menerima data dalam bentuk angka sebagai input.

Dalam library Pandas, fungsi pd.get_dummies() sangat membantu dalam melakukan One Hot Encoding. Fungsi ini akan membuat kolom-kolom baru yang mewakili setiap nilai unik pada fitur kategorikal. Untuk setiap baris, kolom yang sesuai dengan nilai fitur tersebut akan diberi nilai 1, sementara kolom lainnya akan berisi 0.

Sebagai contoh, jika terdapat fitur bernama "Warna" dengan nilai-nilai seperti "Merah", "Biru", dan "Hijau", setelah proses One Hot Encoding akan terbentuk tiga kolom baru, yaitu "Warna_Merah", "Warna_Biru", dan "Warna_Hijau".

Jika suatu baris memiliki nilai "Merah" pada fitur "Warna", maka kolom "Warna_Merah" akan diisi dengan angka 1, sedangkan kolom "Warna_Biru" dan "Warna_Hijau" akan berisi 0.

Pembagian dataset menjadi data training dan data testing merupakan langkah penting dalam pembangunan model machine learning. Tujuannya adalah untuk mengevaluasi kemampuan model dalam memprediksi data yang belum pernah dipelajari sebelumnya serta menghindari masalah overfitting.

Data training digunakan untuk melatih model, sementara data testing berfungsi untuk menguji performa model dalam memprediksi data baru yang tidak termasuk dalam proses pelatihan.

Dengan membagi dataset menjadi dua bagian ini, dapat diukur sejauh mana model mampu melakukan generalisasi dan memberikan prediksi yang akurat pada data yang belum dikenal.

Perbandingan umum yang sering diterapkan adalah rasio 80:20, di mana 80% data digunakan sebagai data training dan 20% sisanya digunakan sebagai data testing.

Rasio ini dianggap memberikan keseimbangan yang baik antara jumlah data yang cukup untuk pelatihan dan data yang memadai untuk pengujian performa model.

Namun demikian, pembagian rasio ini dapat disesuaikan sesuai dengan karakteristik dataset dan kebutuhan spesifik dari proyek yang dijalankan.

## 8. Modeling
Dalam proses modeling, proyek ini akan menggunakan algoritma *SVR* dan algoritma *Huber Regressor* berdasarkan hasil dari data *library* pycaret.

Algoritma Support Vector Regression (SVR) dan Huber Regressor merupakan dua metode yang sering diterapkan dalam masalah regresi. Dalam proyek ini, keduanya digunakan untuk memprediksi premi asuransi kesehatan berdasarkan berbagai faktor risiko yang relevan. Berikut adalah penjelasan konsep dan mekanisme kerja masing-masing algoritma:

1. Support Vector Regression (SVR):

- Konsep: SVR merupakan turunan dari Support Vector Machines (SVM) yang diaplikasikan untuk permasalahan regresi. Tujuan utama SVR adalah menemukan fungsi regresi terbaik yang dapat meminimalkan kesalahan prediksi pada data pelatihan sambil menjaga margin selebar mungkin.

- Mekanisme: SVR mencari hyperplane atau bidang yang memisahkan data pelatihan dengan margin maksimal. Hyperplane tersebut berfungsi sebagai model regresi untuk memprediksi nilai target dari fitur input. SVR mengizinkan adanya titik data yang berada di luar margin tersebut, sehingga mampu mengakomodasi keberadaan pencilan (outlier). Algoritma ini mengoptimalkan margin dengan mempertimbangkan keseimbangan antara kesalahan prediksi dan kompleksitas model.

- Keunggulan: SVR mampu menangani data regresi yang mengandung noise atau pencilan dengan baik. Selain itu, fleksibilitas dalam pemilihan fungsi kernel memungkinkan SVR memodelkan hubungan non-linear antara variabel input dan output.

2. Huber Regressor:

- Konsep: Huber Regressor adalah metode regresi yang tahan terhadap pencilan. Algoritma ini menggabungkan pendekatan Least Squares (LS) dan Least Absolute Deviations (LAD) melalui penggunaan fungsi kerugian Huber.

- Mekanisme: Huber Regressor menghitung residual, yaitu selisih antara nilai prediksi dan nilai aktual. Jika residual berada di bawah ambang tertentu, maka fungsi kerugian Least Squares (kuadrat residual) digunakan. Namun jika residual melebihi ambang tersebut, maka fungsi kerugian berganti ke Least Absolute Deviations (nilai absolut residual). Pendekatan ini membuat Huber Regressor lebih tahan terhadap pengaruh pencilan dibandingkan metode Least Squares biasa.

- Keunggulan: Algoritma ini efektif untuk data yang memiliki pencilan signifikan. Dibandingkan metode Least Squares, Huber Regressor memberikan performa yang lebih stabil dan adaptif terhadap variasi karakteristik data.

Dalam proyek ini, kedua algoritma digunakan untuk membangun model yang mengaitkan faktor risiko dengan premi asuransi kesehatan. Dengan memanfaatkan prinsip dan mekanisme kerja tersebut, SVR dan Huber Regressor diharapkan dapat menghasilkan prediksi premi yang lebih tepat dan tahan terhadap pengaruh pencilan pada data.

### Tahapan yang dilakukan
Berikut adalah urutan tahapan yang dilakukan dalam proses modeling:
 - Melatih model dengan data training dengan menggunakan algoritma *Huber Regressor* dan *SVR*
 - Dalam tahap training, pengujian model dilakukan dengan menggunakan parameter default bawaan *library*
 - Melakukan pengujian dengan data training
 - Melakukan pengujian dengan data testing
 - Pengukuran menggunakan metriks *MSE*,MAE,R*MSE* dan R2 dengan menggunakan lirbary sklearn. 
 - Melihat hasil performa model antara hasil data training dan data testing
 - Meningkatkan performa model dengan menerapkan grid search atau *hyperparameter* pada model
 - Menggunakan *hyperparameter* pada *Huber Regressor* yaitu param_grid = { 'epsilon': [1.0, 1.5, 2.0],'alpha': [0.0001, 0.001, 0.01], 'max_iter': [100, 200, 300]}
 - Menggunakan *hyperparameter* pada *SVR* yaitu param_grid = {'kernel': ['linear', 'rbf'],'C': [0.1, 1, 10],'epsilon': [0.1, 0.2, 0.3]}
 - Setelah pengujian *hyperparameter*, *Huber Regressor* mendapatkan param terbaik yaitu: {'alpha': 0.01, 'epsilon': 2.0, 'max_iter': 100}
 - Setelah pengujian *hyperparameter*, *SVR* mendapatkan param terbaik yaitu: {'C': 1, 'epsilon': 0.1, 'kernel': 'linear'

 - Huber_*MSE*: Rata-rata dari kuadrat selisih antara nilai prediksi dan nilai aktual pada data training adalah sekitar 18,480,694.56826, sedangkan pada data testing sekitar 25,177,990.875244. Hasil ini menunjukkan bahwa model memiliki tingkat kesalahan yang sedikit lebih tinggi pada data testing dibandingkan dengan data training.
 - *SVR*_*MSE*: Rata-rata dari kuadrat selisih antara nilai prediksi dan nilai aktual pada data training adalah sekitar 40,114,366.684487, sedangkan pada data testing sekitar 42,742,505.675315. Hasil ini menunjukkan bahwa model testing memiliki tingkat kesalahan yang sedikit lebih tinggi pada data testing dibandingkan dengan data training.

Kesimpulan yang dapat diambil dari paparan di atas ialah adanya overfitting pada data training karena model cenderung memiliki tingkat kesalahan yang lebih tinggi pada data testing.

### Kelebihan dan Kekurangan
- Algoritma Huber Regressor unggul dalam hal ketahanan terhadap outlier, sehingga mampu memberikan hasil yang lebih stabil dan konsisten dibandingkan regresi linier konvensional.
- Namun, Huber Regressor memiliki kelemahan pada pemilihan nilai delta yang tepat, karena nilai tersebut sangat mempengaruhi performa algoritma. Penentuan parameter ini biasanya memerlukan proses pengujian dan penyesuaian secara manual.
- Algoritma SVR memiliki kelebihan berupa kemampuan menggunakan berbagai fungsi kernel untuk mentransformasikan data input ke ruang fitur berdimensi lebih tinggi. Hal ini memungkinkan pemodelan yang lebih fleksibel, terutama untuk kasus di mana hubungan antara fitur dan target bersifat non-linear.
- Di sisi lain, SVR sangat peka terhadap skala data input. Oleh sebab itu, proses normalisasi atau penskalaan data sangat penting dilakukan sebelum menerapkan SVR agar model tidak mengalami bias yang tidak diinginkan.
- Dengan mempertimbangkan keunggulan dan kelemahan tersebut, algoritma Huber Regressor dianggap lebih unggul dibandingkan SVR. Selanjutnya, penerapan hyperparameter tuning sangat diperlukan saat melakukan evaluasi model untuk mendapatkan hasil yang optimal.

## 9. Evaluation

Metrik evaluasi yang digunakan dalam proyek ini ialah sebagai berikut:

### *MSE*
Mean Square Error (*MSE*) adalah salah satu metrik evaluasi yang digunakan untuk mengukur sejauh mana perbedaan antara nilai prediksi dan nilai sebenarnya dalam masalah regresi. 

Model evaluasi *MSE* menghitung rata-rata dari kuadrat selisih antara nilai prediksi dan nilai sebenarnya. Semakin kecil *MSE*, semakin baik model tersebut dalam melakukan prediksi yang akurat.

Berikut adalah langkah-langkah untuk menghitung *MSE*:

1. Mulai dengan memiliki kumpulan data yang terdiri dari pasangan nilai sebenarnya (y) dan nilai prediksi (ŷ) untuk sejumlah contoh atau sampel.

2. Hitung selisih antara nilai sebenarnya dan nilai prediksi untuk setiap contoh. Selisih ini merupakan error atau kesalahan prediksi untuk masing-masing contoh.

3. Kuadratkan setiap selisih. Ini dilakukan untuk memastikan bahwa setiap error memiliki kontribusi positif terhadap nilai *MSE*, tanpa mempertimbangkan apakah prediksi lebih rendah atau lebih tinggi dari nilai sebenarnya.

4. Hitung rata-rata dari kuadrat selisih. Caranya adalah dengan menjumlahkan semua kuadrat selisih dan membaginya dengan jumlah contoh.

   *MSE* = (Σ (y - ŷ)²) / n
   
   di mana:
   - Σ menunjukkan penjumlahan
   - y adalah nilai sebenarnya
   - ŷ adalah nilai prediksi
   - n adalah jumlah contoh atau sampel dalam dataset.

  5. Setelah menghitung *MSE*, semakin kecil nilai *MSE*, semakin baik model dalam melakukan prediksi yang akurat. *MSE* memiliki satuan yang berbeda dengan variabel yang dievaluasi, karena hasilnya berupa kuadrat. Oleh karena itu, *MSE* seringkali diinterpretasikan dalam konteks yang lebih luas, atau perbandingannya dibandingkan dengan metrik evaluasi lainnya.

Tabel 9.1 Tabel hasil running evaluasi model setelah menggunakan *hyperparameter*
|           | Huber         | SVR            |
|-----------|---------------|----------------|
| train_MSE | 18480694.56826 | 40114366.684487 |
| test_MSE  | 25177990.875244 | 42742505.675315 |
| eval_train | 18104561.09466 | 18614533.696279 |
| eval_test  | 24212812.866265 | 25605704.542962 |

Berikut adalah grafik hasil evaluasi model setelah dilakukan penerapan *hyperparameter*.
![model_eval_hy_params](https://github.com/adhimkhairilanam/Proyek-Pertama-Machine-Learning-Terapan)
###### Gambar 9.1 Hasil evaluasi model setelah penerapan *hyperparameter*

*MSE* merupakan metrik evaluasi yang umum digunakan dalam masalah regresi karena memperhitungkan perbedaan antara nilai prediksi dan nilai sebenarnya secara keseluruhan dan memberikan bobot yang lebih besar pada perbedaan yang besar. 
